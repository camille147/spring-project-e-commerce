<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Export de mes données - TechZone</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-50 p-10 font-sans">

<div class="max-w-4xl mx-auto bg-white shadow-xl rounded-2xl overflow-hidden border border-slate-200">
    <div class="bg-[#1F1F1F] p-8 text-white flex justify-between items-center">
        <div>
            <h1 class="text-2xl font-bold tracking-tight">Rapport de Portabilité des Données</h1>
            <p class="text-slate-400 text-sm mt-1">Généré le <span th:text="${#temporals.format(#temporals.createNow(), 'dd/MM/yyyy HH:mm')}"></span></p>
        </div>
        <div class="text-right">
            <span class="text-[#D4AF37] font-bold text-xl uppercase">TechZone</span>
        </div>
    </div>

    <div class="p-8 space-y-10">
        <section>
            <h2 class="text-[#D4AF37] text-sm font-bold uppercase tracking-widest mb-4 border-b pb-2">Informations Personnelles</h2>
            <div class="grid grid-cols-2 gap-y-4 text-sm">
                <div><p class="text-slate-500">Nom complet</p><p class="font-semibold text-slate-800" th:text="${user.firstName + ' ' + user.lastName}"></p></div>
                <div><p class="text-slate-500">Email</p><p class="font-semibold text-slate-800" th:text="${user.email}"></p></div>
                <div><p class="text-slate-500">Date de naissance</p><p class="font-semibold text-slate-800" th:text="${user.birthDate}"></p></div>
                <div><p class="text-slate-500">Compte créé le</p><p class="font-semibold text-slate-800" th:text="${#temporals.format(user.createdAt, 'dd/MM/yyyy')}"></p></div>
                <div><p class="text-slate-500">Consentement RGPD</p><p class="text-green-600 font-bold">Accepté le <span th:text="${#temporals.format(user.consentDate, 'dd/MM/yyyy')}"></span></p></div>
            </div>
        </section>

        <section>
            <h2 class="text-[#D4AF37] text-sm font-bold uppercase tracking-widest mb-4 border-b pb-2">Adresses Enregistrées</h2>
            <div class="space-y-3">
                <div th:each="addr : ${addresses}" class="p-3 bg-slate-50 rounded-lg border border-slate-100 text-sm">
                    <p class="font-semibold" th:text="${addr.street}"></p>
                    <p class="text-slate-600" th:text="${addr.zipCode + ' ' + addr.city + ', ' + addr.country}"></p>
                </div>
            </div>
        </section>

        <section>
            <h2 class="text-[#D4AF37] text-sm font-bold uppercase tracking-widest mb-4 border-b pb-2">Historique des Transactions</h2>
            <table class="w-full text-left text-sm">
                <thead>
                <tr class="text-slate-400 border-b">
                    <th class="py-2">N° Commande</th>
                    <th class="py-2">Date</th>
                    <th class="py-2 text-right">Montant</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="order : ${orders}" class="border-b border-slate-50 last:border-0">
                    <td class="py-3 font-mono text-xs" th:text="${order.orderNumber}"></td>
                    <td class="py-3 text-slate-600" th:text="${#temporals.format(order.createdAt, 'dd/MM/yyyy')}"></td>
                    <td class="py-3 text-right font-bold" th:text="${order.total + ' €'}"></td>
                </tr>
                </tbody>
            </table>
        </section>
    </div>

    <div class="bg-slate-50 p-6 border-t border-slate-200">
        <p class="text-[10px] text-slate-400 leading-relaxed italic">
            Ce document contient l'intégralité des données à caractère personnel traitées par TechZone vous concernant, conformément à l'Article 20 du RGPD.
            Pour toute demande de suppression, veuillez utiliser la fonction "Supprimer mon compte" dans votre espace client.
        </p>
    </div>
</div>

<div class="max-w-4xl mx-auto mt-6 flex justify-between print:hidden">
    <button onclick="window.print()" class="bg-[#D4AF37] text-white px-6 py-2 rounded-full font-bold shadow-lg hover:scale-105 transition-transform">
        Imprimer ou Sauvegarder en PDF
    </button>
    <a th:href="@{/user/profile}" class="text-slate-400 hover:text-slate-600 flex items-center">
        Retour au profil
    </a>
</div>

</body>
</html>